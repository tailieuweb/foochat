(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{224:function(e,t,a){e.exports=a(477)},244:function(e,t){},246:function(e,t){},276:function(e,t){},277:function(e,t){},321:function(e,t){},323:function(e,t){},346:function(e,t){},45:function(e,t,a){e.exports=a.p+"static/media/bg.e9130941.mp4"},459:function(e,t){},474:function(e,t,a){},475:function(e,t,a){},476:function(e,t,a){},477:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(88),o=a.n(r),c=a(30),i=a(31),l=a(33),m=a(32),u=a(34),d=a(10),h=a(21),f=Object(h.a)(),p=a(40),g=a.n(p),v=a(18),b=a(58),E=a(5),C=a(25),w=a(11),y=a.n(w),O={BASE:"http://localhost:3003",LOCAL:"http://localhost:3003"},N=a(221),j=a.n(N)()(O.LOCAL,{reconnection:!0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,reconnectionAttempts:1/0});j.on("disconnect",(function(){localStorage.userId&&j.emit("user-setOffline",localStorage.userId)}));var S=j,x=a(45),k=a.n(x),M=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).success=function(e,t){var n=JSON.parse(t);200!==e.statusCode?a.setState({isLogin:!1,errMessage:n.message}):(localStorage.setItem("chattoken",n.token),localStorage.setItem("userId",n.user.id),localStorage.setItem("username",n.user.username),S.emit("user-login",n.user.id),f.push("/admin/chat"))},a.state={username:"",password:"",isLogin:!1,errMessage:""},a._isMounted=!1,a.handleSubmit=a.handleSubmit.bind(Object(E.a)(a)),a.onChangeUsername=a.onChangeUsername.bind(Object(E.a)(a)),a.onChangePassword=a.onChangePassword.bind(Object(E.a)(a)),a.success=a.success.bind(Object(E.a)(a)),a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0,this._isMounted&&(document.title="\u0110\u0103ng nh\u1eadp")}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"onChangeUsername",value:function(e){this.setState({username:e.target.value})}},{key:"onChangePassword",value:function(e){this.setState({password:e.target.value})}},{key:"handleSubmit",value:function(){var e=Object(b.a)(g.a.mark((function e(t){var a,n,s=this;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!this._isMounted){e.next=9;break}if((a={username:this.state.username,password:this.state.password}).username&&a.password){e.next=6;break}return this.setState({errMessage:"Please input username or password"}),e.abrupt("return");case 6:this.setState({isLoggin:!0}),n={uri:O.LOCAL+"/api/login",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object(v.a)({},a))},y.a.post(n,(function(e,t,a){s.success(t,a)}));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return localStorage.getItem("chattoken")?s.a.createElement(d.a,{to:"/admin/chat",push:!0}):s.a.createElement("section",{className:"auth-page"},s.a.createElement("video",{autoPlay:!0,muted:!0,loop:!0,id:"bg-video"},s.a.createElement("source",{src:k.a,type:"video/mp4"})),s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"display-screen"},s.a.createElement("h1",{className:"text-center display-4"},"Login Admin"),s.a.createElement("form",{method:"POST",onSubmit:this.handleSubmit},s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"username"},"T\xean t\xe0i kho\u1ea3n"),s.a.createElement("input",{type:"text",onChange:this.onChangeUsername,name:"username",id:"username",value:this.state.username,className:"form-control",autoComplete:"off",spellCheck:"false"})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"password"},"M\u1eadt kh\u1ea9u"),s.a.createElement("input",{type:"password",onChange:this.onChangePassword,name:"password",id:"password",value:this.state.password,className:"form-control",autoComplete:"off",spellCheck:"false"})),s.a.createElement("div",{className:"form-group submit"},s.a.createElement("button",{type:"submit",className:"btn btn-primary"},this.state.isLogin?"Processsing":"Login")),0!==this.state.errMessage.length?s.a.createElement("p",null,this.state.errMessage,"."):null,s.a.createElement("div",{className:"text-center"},s.a.createElement(C.a,{to:"/admin/register",className:"inline-block text-sm text-blue-500 align-baseline hover:text-blue-800"},"B\u1ea1n ch\u01b0a c\xf3 t\xe0i kho\u1ea3n? \u0110\u0103ng k\xfd n\xe0o!"))))))}}]),t}(s.a.Component),_=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).success=function(e,t){200!==e.statusCode?a.setState({isRegistering:!1,errMessage:"Co loi xay ra"}):(f.push("/admin"),a._isMounted&&a.setState({isRegistering:!1}))},a.state={fullname:"",email:"",username:"",password:"",cf_password:"",isRegistering:!1,errMessage:""},a._isMounted=!1,a.onChangeFullname=a.onChangeFullname.bind(Object(E.a)(a)),a.onChangeEmail=a.onChangeEmail.bind(Object(E.a)(a)),a.onChangeUsername=a.onChangeUsername.bind(Object(E.a)(a)),a.onChangePassword=a.onChangePassword.bind(Object(E.a)(a)),a.onChangeCfPassword=a.onChangeCfPassword.bind(Object(E.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(E.a)(a)),a.success=a.success.bind(Object(E.a)(a)),a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0,this._isMounted&&(document.title="\u0110\u0103ng k\xfd")}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"onChangeFullname",value:function(e){this.setState({fullname:e.target.value})}},{key:"onChangeEmail",value:function(e){this.setState({email:e.target.value})}},{key:"onChangeUsername",value:function(e){this.setState({username:e.target.value})}},{key:"onChangePassword",value:function(e){this.setState({password:e.target.value})}},{key:"onChangeCfPassword",value:function(e){this.setState({cf_password:e.target.value})}},{key:"handleSubmit",value:function(e){var t=this;if(e.preventDefault(),this._isMounted){var a={fullname:this.state.fullname,email:this.state.email,username:this.state.username,password:this.state.password,cf_password:this.state.cf_password,admin:!0};if(!(a.username&&a.password&&a.cf_password))return void this.setState({errMessage:"Please input username or password"});if(a.password!==a.cf_password)return void this.setState({errMessage:"Password do not match"});this.setState({isRegistering:!0});var n={uri:O.LOCAL+"/api/register",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object(v.a)({},a))};y.a.post(n,(function(e,a,n){t.success(a,n)}))}}},{key:"render",value:function(){return s.a.createElement("section",{className:"auth-page"},s.a.createElement("video",{autoPlay:!0,muted:!0,loop:!0,id:"bg-video"},s.a.createElement("source",{src:k.a,type:"video/mp4"})),s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"display-screen"},s.a.createElement("h1",{className:"text-center display-4"},"Register Admin"),s.a.createElement("form",{method:"POST",onSubmit:this.handleSubmit},s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"fullname"},"T\xean \u0111\u1ea7y \u0111\u1ee7"),s.a.createElement("input",{type:"text",name:"fullname",id:"fullname",value:this.state.fullname,onChange:this.onChangeFullname,className:"form-control",autoComplete:"off",spellCheck:"false"})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"email"},"Email"),s.a.createElement("input",{type:"email",name:"email",id:"email",value:this.state.email,onChange:this.onChangeEmail,className:"form-control",autoComplete:"off",spellCheck:"false"})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"username"},"T\xean t\xe0i kho\u1ea3n"),s.a.createElement("input",{name:"username",id:"username",value:this.state.username,onChange:this.onChangeUsername,className:"form-control",autoComplete:"off",spellCheck:"false"})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"password"},"M\u1eadt kh\u1ea9u"),s.a.createElement("input",{type:"password",name:"password",id:"password",value:this.state.password,onChange:this.onChangePassword,className:"form-control",autoComplete:"off",spellCheck:"false"})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"cf_password"},"X\xe1c nh\u1eadn m\u1eadt kh\u1ea9u"),s.a.createElement("input",{type:"password",name:"cf_password",id:"cf_password",value:this.state.cf_password,onChange:this.onChangeCfPassword,className:"form-control",autoComplete:"off",spellCheck:"false"})),s.a.createElement("div",null,this.state.errMessage&&0!==this.state.errMessage.length?s.a.createElement("p",null,this.state.errMessage,"."):null),s.a.createElement("div",{className:"form-group submit"},s.a.createElement("button",{type:"submit",className:"btn btn-primary"},this.state.isRegistering?"Processing":"Register")),s.a.createElement("div",{className:"text-center"},s.a.createElement(C.a,{to:"/admin"},"T\xf4i \u0111\xe3 c\xf3 t\xe0i kho\u1ea3n!"))))))}}]),t}(s.a.Component),I=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).success=function(e,t){var n=JSON.parse(t);200!==e.statusCode?a.setState({isLogin:!1,errMessage:n.message}):(localStorage.setItem("chattoken",n.token),localStorage.setItem("userId",n.user.id),localStorage.setItem("username",n.user.username),S.emit("user-login",n.user.id),f.push("/chat"))},a.state={username:"",password:"",isLogin:!1,errMessage:""},a._isMounted=!1,a.handleSubmit=a.handleSubmit.bind(Object(E.a)(a)),a.onChangeUsername=a.onChangeUsername.bind(Object(E.a)(a)),a.onChangePassword=a.onChangePassword.bind(Object(E.a)(a)),a.success=a.success.bind(Object(E.a)(a)),a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0,this._isMounted&&(document.title="\u0110\u0103ng nh\u1eadp")}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"onChangeUsername",value:function(e){this.setState({username:e.target.value})}},{key:"onChangePassword",value:function(e){this.setState({password:e.target.value})}},{key:"handleSubmit",value:function(){var e=Object(b.a)(g.a.mark((function e(t){var a,n,s=this;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!this._isMounted){e.next=9;break}if((a={username:this.state.username,password:this.state.password}).username&&a.password){e.next=6;break}return this.setState({errMessage:"Please input username or password"}),e.abrupt("return");case 6:this.setState({isLoggin:!0}),n={uri:O.LOCAL+"/api/login",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object(v.a)({},a))},y.a.post(n,(function(e,t,a){s.success(t,a)}));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return localStorage.getItem("chattoken")?s.a.createElement(d.a,{to:"/user/chat",push:!0}):s.a.createElement("section",{className:"auth-page"},s.a.createElement("video",{autoPlay:!0,muted:!0,loop:!0,id:"bg-video"},s.a.createElement("source",{src:k.a,type:"video/mp4"})),s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"display-screen"},s.a.createElement("h1",{className:"text-center display-4"},"Login"),s.a.createElement("form",{method:"POST",onSubmit:this.handleSubmit},s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"username"},"T\xean t\xe0i kho\u1ea3n"),s.a.createElement("input",{type:"text",onChange:this.onChangeUsername,name:"username",id:"username",value:this.state.username,className:"form-control",autoComplete:"off",spellCheck:"false"})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"password"},"M\u1eadt kh\u1ea9u"),s.a.createElement("input",{type:"password",onChange:this.onChangePassword,name:"password",id:"password",value:this.state.password,className:"form-control",autoComplete:"off",spellCheck:"false"})),s.a.createElement("div",{className:"form-group submit"},s.a.createElement("button",{type:"submit",className:"btn btn-primary"},this.state.isLogin?"Processsing":"Login")),0!==this.state.errMessage.length?s.a.createElement("p",null,this.state.errMessage,"."):null,s.a.createElement("div",{className:"text-center"},s.a.createElement(C.a,{to:"/register",className:"inline-block text-sm text-blue-500 align-baseline hover:text-blue-800"},"B\u1ea1n ch\u01b0a c\xf3 t\xe0i kho\u1ea3n? \u0110\u0103ng k\xfd n\xe0o!"))))))}}]),t}(s.a.Component),P=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).success=function(e,t){200!==e.statusCode?a.setState({isRegistering:!1,errMessage:"Co loi xay ra"}):(f.push("/admin"),a._isMounted&&a.setState({isRegistering:!1}))},a.state={fullname:"",email:"",username:"",password:"",cf_password:"",isRegistering:!1,errMessage:""},a._isMounted=!1,a.onChangeFullname=a.onChangeFullname.bind(Object(E.a)(a)),a.onChangeEmail=a.onChangeEmail.bind(Object(E.a)(a)),a.onChangeUsername=a.onChangeUsername.bind(Object(E.a)(a)),a.onChangePassword=a.onChangePassword.bind(Object(E.a)(a)),a.onChangeCfPassword=a.onChangeCfPassword.bind(Object(E.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(E.a)(a)),a.success=a.success.bind(Object(E.a)(a)),a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0,this._isMounted&&(document.title="\u0110\u0103ng k\xfd")}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"onChangeFullname",value:function(e){this.setState({fullname:e.target.value})}},{key:"onChangeEmail",value:function(e){this.setState({email:e.target.value})}},{key:"onChangeUsername",value:function(e){this.setState({username:e.target.value})}},{key:"onChangePassword",value:function(e){this.setState({password:e.target.value})}},{key:"onChangeCfPassword",value:function(e){this.setState({cf_password:e.target.value})}},{key:"handleSubmit",value:function(e){var t=this;if(e.preventDefault(),this._isMounted){var a={fullname:this.state.fullname,email:this.state.email,username:this.state.username,password:this.state.password,cf_password:this.state.cf_password};if(!(a.username&&a.password&&a.cf_password))return void this.setState({errMessage:"Please input username or password"});if(a.password!==a.cf_password)return void this.setState({errMessage:"Password do not match"});this.setState({isRegistering:!0});var n={uri:O.LOCAL+"/api/register",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object(v.a)({},a))};y.a.post(n,(function(e,a,n){t.success(a,n)}))}}},{key:"render",value:function(){return s.a.createElement("section",{className:"auth-page"},s.a.createElement("video",{autoPlay:!0,muted:!0,loop:!0,id:"bg-video"},s.a.createElement("source",{src:k.a,type:"video/mp4"})),s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"display-screen"},s.a.createElement("h1",{className:"text-center display-4"},"\u0110\u0103ng k\xfd t\xe0i kho\u1ea3n"),s.a.createElement("form",{method:"POST",onSubmit:this.handleSubmit},s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"fullname"},"T\xean \u0111\u1ea7y \u0111\u1ee7"),s.a.createElement("input",{type:"text",name:"fullname",id:"fullname",value:this.state.fullname,onChange:this.onChangeFullname,className:"form-control",autoComplete:"off",spellCheck:"false"})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"email"},"Email"),s.a.createElement("input",{type:"email",name:"email",id:"email",value:this.state.email,onChange:this.onChangeEmail,className:"form-control",autoComplete:"off",spellCheck:"false"})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"username"},"T\xean t\xe0i kho\u1ea3n"),s.a.createElement("input",{name:"username",id:"username",value:this.state.username,onChange:this.onChangeUsername,className:"form-control",autoComplete:"off",spellCheck:"false"})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"password"},"M\u1eadt kh\u1ea9u"),s.a.createElement("input",{type:"password",name:"password",id:"password",value:this.state.password,onChange:this.onChangePassword,className:"form-control",autoComplete:"off",spellCheck:"false"})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"cf_password"},"X\xe1c nh\u1eadn m\u1eadt kh\u1ea9u"),s.a.createElement("input",{type:"password",name:"cf_password",id:"cf_password",value:this.state.cf_password,onChange:this.onChangeCfPassword,className:"form-control",autoComplete:"off",spellCheck:"false"})),s.a.createElement("div",null,this.state.errMessage&&0!==this.state.errMessage.length?s.a.createElement("p",null,this.state.errMessage,"."):null),s.a.createElement("div",{className:"form-group submit"},s.a.createElement("button",{type:"submit",className:"btn btn-primary"},this.state.isRegistering?"Processing":"Register")),s.a.createElement("div",{className:"text-center"},s.a.createElement(C.a,{to:"/"},"T\xf4i \u0111\xe3 c\xf3 t\xe0i kho\u1ea3n!"))))))}}]),t}(s.a.Component),L=a(9),T=a(46),A=function(e,t){switch(t.type){case"update":return{conversations:Object(T.a)(t.conversations),ready:!0};case"toggle-emoji":return Object(v.a)({},e,{isEmojiShow:t.status});case"refresh":return Object(v.a)({},e,{refresh:!e.refresh});case"update-single":var a=e.conversations.filter((function(e){return t.conversation._id!==e._id}));return Object(v.a)({},e,{conversations:[t.conversation].concat(Object(T.a)(a)),refresh:!e.refresh});case"add":return{conversations:[t.conversation].concat(Object(T.a)(e.conversations))};case"update-input":return Object(v.a)({},e,{inputEvent:t.inputEvent});case"new-message":return console.log(t),Object(v.a)({},e,{newMessage:{cid:t.conversation._id,message:t.message}});default:return e}},F={conversations:[],ready:!1,sessionValid:!0,refresh:!1,newMessage:{cid:"",message:{}},isEmojiShow:!1,inputEvent:{}},U=Object(n.createContext)(F),R=function(e){var t=e.children,a=Object(n.useReducer)(A,F),r=Object(L.a)(a,2),o=r[0],c=r[1];Object(n.useEffect)((function(){!function(){var e=Object(b.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={uri:"".concat(O.LOCAL,"/api/conversation-list?id=").concat(localStorage.userId),method:"get",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.chattoken)}},y.a.get(t,(function(e,t,a){if(e||200!==t.statusCode)localStorage.removeItem("chattoken"),localStorage.removeItem("username"),localStorage.removeItem("userId"),f.replace("/");else{var n=JSON.parse(a);i(n.list)}}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[]);var i=function(e){c({type:"update",conversations:e})};return s.a.createElement(U.Provider,{value:{conversations:o.conversations,newMessage:o.newMessage,isEmojiShow:o.isEmojiShow,isReady:o.ready,refresh:o.refresh,inputEvent:o.inputEvent,updateRefresh:function(){c({type:"refresh"})},updateConversations:i,updateConversation:function(e){c({type:"update-single",conversation:e})},getConversation:function(e){return o.conversations.find((function(t){return t._id===e}))||0},addConversation:function(e){c({type:"add",conversation:e})},addNewMessage:function(e){var t=e.conversation,a=e.message;c({type:"new-message",conversation:t,message:a})},toggleEmoji:function(e){c({type:"toggle-emoji",status:e})},updateInputEvent:function(e){c({type:"update-input",inputEvent:e})}}},t)},B=function(e){return"https://ui-avatars.com/api/?uppercase=true&name=".concat(e,"&rounded=true&bold=true&background=65a69a&color=fff&size=128&length=4&font-size=0.2")},J=function(){var e=Object(n.useState)(!1),t=Object(L.a)(e,2),a=t[0],r=t[1];return a?s.a.createElement(d.a,{to:"/",push:!0}):s.a.createElement("button",{className:"btn btn-danger",onClick:function(){!0===window.confirm("B\u1ea1n c\xf3 mu\u1ed1n \u0111\u0103ng xu\u1ea5t kh\xf4ng?")&&(localStorage.removeItem("chattoken"),localStorage.removeItem("username"),localStorage.removeItem("userId"),r(!0))}},s.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",className:""},s.a.createElement("path",{d:"M10 9.408l2.963 2.592-2.963 2.592v-1.592h-8v-2h8v-1.592zm-2-4.408v4h-8v6h8v4l8-7-8-7zm6-3c-1.787 0-3.46.474-4.911 1.295l.228.2 1.396 1.221c1.004-.456 2.114-.716 3.287-.716 4.411 0 8 3.589 8 8s-3.589 8-8 8c-1.173 0-2.283-.26-3.288-.715l-1.396 1.221-.228.2c1.452.82 3.125 1.294 4.912 1.294 5.522 0 10-4.477 10-10s-4.478-10-10-10z"})))},z=function(){return s.a.createElement("div",{className:"panel"},s.a.createElement("div",{className:"d-flex justify-content-center bg-part"},s.a.createElement("div",{className:"col-lg-8 d-flex align-items-center"},s.a.createElement("img",{src:B(localStorage.username),className:"avt-ico",alt:"My avatar"}),s.a.createElement("h1",{className:"display-5"},"Chat")),s.a.createElement("div",{className:"col-lg-4 d-flex align-items-center justify-content-center"},s.a.createElement(J,null))))},D=function(e){var t=e.conversation,a=e.otherName;return s.a.createElement(C.b,{to:"/admin/chat/".concat(t._id),className:"flex h-16 max-w-full rounded-lg cursor-pointer",activeClassName:"bg-gray-300"},s.a.createElement("img",{src:B(a),className:"avt-ico",alt:"avatar"}),s.a.createElement("div",{className:"hidden md:flex flex-col h-full justify-center overflow-hidden"},s.a.createElement("span",{className:"display-username"},a),t.lastSender?s.a.createElement("div",{className:"flex mr-2"},s.a.createElement("p",{className:"text-sm  text-gray-700 truncate max-w-full"},t.lastSender,": ",t.lastMessage)):null))},W=function(e){var t=Object(n.useContext)(U),a=t.conversations,r=t.addConversation,o=localStorage.username,c=localStorage.userId;return Object(n.useEffect)((function(){S.on("add-new-conversation",(function(e){var t=e.conversation,a=e.receiveId;c===a&&r(t)}))}),[]),Object(n.useEffect)((function(){a&&(a.forEach((function(e){S.emit("user-join-room",{roomId:e._id})})),!e.chatId&&a.length>0&&f.replace("/admin/chat/".concat(a[0]._id)))}),[a.length]),s.a.createElement("div",{className:"flex flex-col items-center overflow-y-auto flex-grow max-height"},s.a.createElement("div",{className:"w-full px-2 overflow-y-auto"},a.map((function(e){return s.a.createElement(D,{key:e._id,conversation:e,otherName:o===e.firstUserName?e.secondUserName:e.firstUserName})}))))},G=function(e){var t=e.searchOnFocus,a=e.searchOutFocus,n=e.searchPeople;return s.a.createElement("div",{className:"box-search px-2 mb-4 position-relative"},s.a.createElement("svg",{className:"center-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},s.a.createElement("path",{d:"M12.9 14.32a8 8 0 1 1 1.41-1.41l5.35 5.33-1.42 1.42-5.33-5.34zM8 14A6 6 0 1 0 8 2a6 6 0 0 0 0 12z"})),s.a.createElement("input",{type:"search",className:"w-full px-12 py-2 bg-gray-200 text-gray-700 rounded-full outline-none",placeholder:"T\xecm ki\u1ebfm user",onFocus:function(){return t()},onBlur:function(e){return a(e)},onChange:function(e){n(e.target.value)}}))},X=function(e){return s.a.createElement("div",{className:"flex h-12 max-w-full hover:bg-gray-300 rounded-lg cursor-pointer",onClick:function(){e.openConversation(e.id)}},s.a.createElement("img",{src:B(e.username),className:"h-12 w-12 mx-4 p-1 rounded-full",alt:"avatar"}),s.a.createElement("div",{className:"hidden md:flex flex-col h-full justify-center items-center overflow-hidden"},s.a.createElement("span",{className:"text-base truncate"},e.username)))},H=function(e){var t=e.listResults,a=e.openConversation,n=e.setMouse,r=localStorage.username,o=t;return o.find((function(e,t){return e.username===r?0===t:""})),o.slice(0,1,1),s.a.createElement("div",{className:"px-2 mr-1 overflow-y-auto",onMouseOver:function(){return n(!0)},onMouseOut:function(){return n(!1)}},t.map((function(e){return s.a.createElement(X,{key:e._id,username:e.username,id:e._id,openConversation:a})})))},K=function(e){var t=Object(n.useContext)(U),a=t.addConversation,r=t.getConversation,o=Object(n.useState)(!1),c=Object(L.a)(o,2),i=c[0],l=c[1],m=Object(n.useState)(!1),u=Object(L.a)(m,2),d=u[0],h=u[1],p=Object(n.useState)([]),g=Object(L.a)(p,2),v=g[0],b=g[1],E=localStorage.userId,C=function(e){var t={uri:O.LOCAL+"/api/search?s=".concat(e),method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.chattoken)}};y.a.get(t,(function(e,t,a){var n=JSON.parse(a),s=localStorage.username,r=(n=n.result).findIndex((function(e){return e.username===s}));n=n.splice(r+1,1),200===t.statusCode?b(Object(T.a)(n)):v.length=0}))};return s.a.createElement("div",{className:"float-1"},s.a.createElement("div",{className:"chat-list"},s.a.createElement(z,null),s.a.createElement(G,{searchOnFocus:function(){l(!0),C("")},searchOutFocus:function(e){e.target.value="",l(!1)},searchPeople:C}),i||d?s.a.createElement(H,{className:"flex-grow",listResults:v,setMouse:function(e){h(e)},openConversation:function(e){var t={uri:O.LOCAL+"/api/conversation?id1=".concat(E,"&id2=").concat(e),method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.chattoken)}};y.a.get(t,(function(e,t,n){if(!e&&200===t.statusCode){var s=JSON.parse(n);r(s.conversation._id)||(a(s.conversation),S.emit("new-conversation",{conversation:s.conversation,createId:localStorage.userId})),l(!1),h(!1),f.push("/admin/chat/".concat(s.conversation._id))}}))}}):s.a.createElement(W,{className:"flex-grow",chatId:e.chatId})))},V=function(e){var t=e.name;return s.a.createElement("div",{className:"title-bar"},s.a.createElement("div",{className:"d-flex bg-part"},s.a.createElement("div",{className:"d-flex align-items-center px-2"},s.a.createElement("img",{src:B(t),className:"avt-ico",alt:"avt"}),s.a.createElement("h1",{className:"display-5"},t))))},Y=function(e){var t=e.message,a=e.myId,n=e.name;return t.ofUser!==a?s.a.createElement("div",{className:"flex mx-3 mt-4 max-w-xs"},s.a.createElement("img",{src:B(n),alt:"avatar",className:"h-8 w-8 self-end mr-2"}),s.a.createElement("div",{className:"py-2 px-4 bg-gray-300 rounded-xl"},s.a.createElement("p",{className:"text-black max-w-xs break-words"},t.content))):s.a.createElement("div",{className:"mx-3 mt-4 flex self-end"},s.a.createElement("div",{className:"py-2 px-4 bg-gray-900 rounded-xl  "},s.a.createElement("p",{className:"text-white max-w-xs break-words"},t.content)))},q=a(223),Q=function(e){var t=e.name;return s.a.createElement("div",{className:"flex mx-3 mt-4 max-w-xs"},s.a.createElement("img",{src:B(t),alt:"avatar",className:"h-8 w-8 self-end mr-2"}),s.a.createElement("div",{className:"py-2 px-4 bg-gray-300 rounded-xl"},s.a.createElement("div",{className:"text-black max-w-xs break-words"},s.a.createElement("div",{className:"ticontainer"},s.a.createElement("div",{className:"tiblock"},s.a.createElement("div",{className:"tidot"}),s.a.createElement("div",{className:"tidot"}),s.a.createElement("div",{className:"tidot"}))))))},Z=function(e){var t=Object(n.useContext)(U),a=t.isReady,r=t.newMessage,o=e.conversation,c=localStorage.userId,i=Object(n.useState)([]),l=Object(L.a)(i,2),m=l[0],u=l[1],d=Object(n.useState)(!1),h=Object(L.a)(d,2),f=h[0],p=h[1],g=Object(n.useState)(""),v=Object(L.a)(g,2),b=v[0],E=v[1],C=Object(n.useState)(!0),w=Object(L.a)(C,2),N=w[0],j=w[1];return Object(n.useEffect)((function(){if(j(!0),u([]),o._id){var e={uri:"".concat(O.LOCAL,"/api/get-messages?cid=").concat(o._id),method:"get",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.chattoken)}};y.a.get(e,(function(e,t,a){if(200===t.statusCode){var n=JSON.parse(a).messageList;u(n),j(!1)}})),S.on("user-typing",(function(e){var t=e.cid,a=e.uid,n=e.isTyping,s=e.name;t===o._id&&a!==c&&(E(s),p(n!==f&&n))}))}}),[a,o._id]),Object(n.useEffect)((function(){o._id&&r&&o._id===r.cid&&u([].concat(Object(T.a)(m),[r.message]))}),[r]),Object(n.useEffect)((function(){q.animateScroll.scrollToBottom({containerId:"messages",smooth:!1,duration:0})}),[m,f,N]),s.a.createElement("div",{className:"bg-white flex-grow d-flex flex-col overflow-y-auto max-height",id:"messages"},N?"":m.map((function(t){return s.a.createElement(Y,{key:t._id||Date.now(),name:e.name,message:t,myId:c})})),f?s.a.createElement(Q,{name:b}):null)},$=a(89),ee=a.n($),te=function(e){var t=e.cid,a=e.uid;console.log(t+", "+a);var r=Object(n.useRef)(null),o=Object(n.useContext)(U),c=o.updateConversation,i=o.addNewMessage,l=o.isReady,m=Object(n.useState)(!1),u=Object(L.a)(m,2),d=u[0],h=u[1],f=Object(n.useState)(!1),p=Object(L.a)(f,2),g=p[0],b=p[1],E=Object(n.useState)("none"),C=Object(L.a)(E,2),w=C[0],N=C[1];console.log(w);var j=Object(n.useState)(null),x=Object(L.a)(j,2),k=(x[0],x[1]);Object(n.useEffect)((function(){if(l){var e={id:a},t={uri:O.LOCAL+"/api/getuser",method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.chattoken)},body:JSON.stringify(Object(v.a)({},e))};y.a.post(t,(function(e,t,a){var n=JSON.parse(a);200===t.statusCode&&(console.log(n.result.isBlock),b(n.result.isBlock))}))}}),[l]);var M=null,_=localStorage.username,I=function(){var e=r.current.value;if(r.current.value="",e&&""!==e){h(!0);var n={uri:"".concat(O.LOCAL,"/api/send-message"),method:"post",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.chattoken)},body:JSON.stringify({cid:t,uid:a,content:e,username:_})};y.a.post(n,(function(e,t,a){if(200!==t.statusCode);else{var n=JSON.parse(a);i({conversation:n.conversation,message:n.newMessage}),c(n.conversation),M&&clearTimeout(M),P(),S.emit("user-send-message",{conversation:n.conversation,newMessage:n.newMessage})}h(!1)}))}},P=function(){S.emit("user-typing-message",{cid:t,uid:a,isTyping:!1})};return s.a.createElement("div",{className:"w-full h-16 bg-white flex p-2"},s.a.createElement("div",{className:"flex-grow flex-shrink d-flex align-items-center position-relative"},s.a.createElement("input",{disabled:g,type:"search",ref:r,className:"px-4 py-2 w-full bg-gray-300 text-gray-900 rounded-full outline-none truncate",onChange:function(){S.emit("user-typing-message",{cid:t,uid:a,isTyping:!0,name:_}),M&&clearTimeout(M),M=setTimeout(P,1500)},onKeyPress:function(e){"Enter"!==e.key&&13!==e.keyCode||I()},placeholder:g?"You have blocked chat":"Input your message..."}),s.a.createElement("div",{className:"sticker position-absolute",style:{display:w}},s.a.createElement(ee.a,{onEmojiClick:function(e,t){k(t),r.current.value+=t.emoji}})),s.a.createElement("div",{className:"btn-emoji",onClick:function(){return N("none"===w?"block":"none")},style:{display:g?"none":"block"}})),s.a.createElement("button",{className:"flex-shrink-0 my-1 mx-2 bg-blue-500 rounded-full  focus:outline-none",style:{flexBasis:50},onClick:I,disabled:d||g},d?s.a.createElement("div",{className:"spinner"},"A"):s.a.createElement("div",{className:"flex items-center justify-center text-white "},s.a.createElement("svg",{className:"h-4 w-4 fill-current",viewBox:"0 0 1000 1000",xmlns:"http://www.w3.org/2000/svg"},s.a.createElement("path",{d:"M10,991.1l980-493.2L10,8.9l101.1,415.7l532.7,73.4l-532.7,70.5L10,991.1z"})))))},ae=function(e){var t=e.chatId,a=e.userId,r=Object(n.useContext)(U),o=r.getConversation,c=r.updateConversation,i=r.addConversation,l=r.addNewMessage,m=r.isReady,u=o(t),d=(a===u.firstId?u.secondUserName:u.firstUserName)||"";return Object(n.useEffect)((function(){m&&S.on("receive-message",(function(e){var t=e.conversation,a=e.newMessage;if(o(t._id)){if(localStorage.username===t.lastSender)return;c(t),l({conversation:t,message:a})}else i(t)}))}),[m]),s.a.createElement("div",{className:"float-2"},s.a.createElement("div",{className:"chat-box"},s.a.createElement(V,{name:d,className:"self-start"}),s.a.createElement(Z,{name:d,conversation:u}),s.a.createElement("div",{className:"w-full px-4 mt-1"},s.a.createElement(te,{cid:t,uid:a,className:"w-7/8 self-end"}))))},ne=function(e){var t=Object(n.useState)([]),a=Object(L.a)(t,2),r=a[0],o=a[1],c=Object(n.useState)(!1),i=Object(L.a)(c,2),l=(i[0],i[1]),m=Object(n.useState)(!1),u=Object(L.a)(m,2),d=(u[0],u[1],Object(n.useContext)(U)),h=d.getConversation,f=d.isReady,p=h(e.chatId),g="";p&&(g=e.userId===p.firstId?p.secondId:p.firstId,console.log(g));var b=[];""!==g&&(b={id:g});return Object(n.useEffect)((function(){if(f){!function(){var e={uri:O.LOCAL+"/api/getuser",method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.chattoken)},body:JSON.stringify(Object(v.a)({},b))};y.a.post(e,(function(e,t,a){var n=JSON.parse(a);200===t.statusCode&&o(n.result)}))}()}}),[g]),s.a.createElement("div",{className:"float-3"},"user"===r.rule?s.a.createElement("div",{className:"info-user"},s.a.createElement("div",{className:"px-2 title-bar d-flex align-items-center"},s.a.createElement("h2",null,"C\xf4ng c\u1ee5")),s.a.createElement("div",{className:"info"},s.a.createElement("h3",{className:"text-center mb-3"},"Th\xf4ng tin user"),s.a.createElement("ul",null,s.a.createElement("li",null,"ID:"," ",s.a.createElement("span",{className:"text-border"},r._id)),s.a.createElement("li",null,"H\u1ecd v\xe0 t\xean:",s.a.createElement("span",{className:"text-border"},r.fullname)),s.a.createElement("li",null,"Username:"," ",s.a.createElement("span",{className:"text-border"},r.username)),s.a.createElement("li",null,"Email:"," ",s.a.createElement("span",{className:"text-border"},r.email)))),s.a.createElement("hr",{className:"my-5"}),s.a.createElement("div",{className:"tool"},s.a.createElement("button",{onClick:function(){return function(e){if(f){var t={uri:O.LOCAL+"/api/block_chat",method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.chattoken)},body:JSON.stringify({id:e})};y.a.post(t,(function(e,t,a){200===t.statusCode&&l(!0)}))}}(g)},type:"button",className:"btn btn-danger"},"C\u1ea5m chat"))):"")},se=function(e){var t=localStorage.userId,a=e.match.params.id;return Object(n.useEffect)((function(){document.title="Chat"}),[]),s.a.createElement(R,null,s.a.createElement("div",{className:"chat"},s.a.createElement("div",{className:"container-fluid"},s.a.createElement("div",{className:"float-content"},s.a.createElement(K,{chatId:a}),s.a.createElement(ae,{chatId:a,userId:t}),s.a.createElement(ne,{chatId:a,userId:t})))))},re=(a(473),a(474),a(475),a(476),function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return s.a.createElement(d.c,{history:f},s.a.createElement(d.d,null,s.a.createElement(d.b,{exact:!0,path:"/admin",component:M}),s.a.createElement(d.b,{exact:!0,path:"/admin/register",component:_}),s.a.createElement(d.b,{exact:!0,path:"/",component:I}),s.a.createElement(d.b,{exact:!0,path:"/register",component:P}),s.a.createElement(d.b,{exact:!0,path:"/admin/chat",component:se}),s.a.createElement(d.b,{exact:!0,path:"/admin/chat/:id",component:se})))}}]),t}(s.a.Component));o.a.render(s.a.createElement(re,null),document.getElementById("root"))}},[[224,1,2]]]);
//# sourceMappingURL=main.b250c890.chunk.js.map